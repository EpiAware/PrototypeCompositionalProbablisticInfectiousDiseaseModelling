# 4-Panel Composability Figure: Single Mermaid Diagram

```{mermaid}
%%| label: fig-case-studies
%%| fig-cap: "Model structure for the ARIMA example and three case studies showing component reuse. Panel A shows ARIMA(2,1,1) composition from AR, MA, and differencing components. Panels B, C, and D show the directed acyclic graphs for each case study, highlighting shared components across applications."
%%| fig-width: 8

flowchart TB
    %% Class definitions
    classDef infection fill:#9fc5e8,stroke:#333,stroke-width:1px,color:black
    classDef statistical fill:#ff9900,stroke:#333,stroke-width:1px,color:black
    classDef epiLatent fill:#d5a6bd,stroke:#333,stroke-width:1px,color:black
    classDef observationModifier fill:#ff9999,stroke:#333,stroke-width:1px,color:black
    classDef observation fill:#b6d7a8,stroke:#333,stroke-width:1px,color:black
    classDef title fill:none,stroke:none,color:black,font-weight:bold

    %% Panel A: ARIMA Construction
    subgraph A["A: ARIMA(2,1,1) Construction"]
        direction LR
        A_AR["AR(2)"]:::statistical
        A_MA["MA(1)"]:::statistical
        A_ARMA["ARMA(2,1)"]:::statistical
        A_DIFF["Diff"]:::statistical
        A_ARIMA["ARIMA(2,1,1)"]:::statistical

        A_AR --> A_ARMA
        A_MA --> A_ARMA
        A_ARMA --> A_DIFF
        A_DIFF --> A_ARIMA
    end

    %% Panel B: Case Study 1
    subgraph B["B: Case Study 1 - South Korea COVID-19"]
        direction TB
        B_AR["AR"]:::statistical
        B_Rt["Rt"]:::epiLatent
        B_Renewal["Renewal"]:::infection
        B_Infections["Infections"]
        B_Obs["Poisson"]:::observation
        B_Cases["Cases"]

        B_AR --> B_Rt
        B_Rt --> B_Renewal
        B_Renewal --> B_Infections
        B_Infections --> B_Obs
        B_Obs --> B_Cases
    end

    %% Panel C: Case Study 2
    subgraph C["C: Case Study 2 - EpiNow2"]
        direction TB
        C_ARIMA["ARIMA"]:::statistical
        C_Rt["Rt"]:::epiLatent
        C_Renewal["Renewal"]:::infection
        C_Infections["Infections"]
        C_Delay["Delay"]:::observationModifier
        C_DoW["Day-of-week"]:::observationModifier
        C_Obs["NegBinom"]:::observation
        C_Cases["Cases"]

        C_ARIMA --> C_Rt
        C_Rt --> C_Renewal
        C_Renewal --> C_Infections
        C_Infections --> C_Delay
        C_Delay --> C_DoW
        C_DoW --> C_Obs
        C_Obs --> C_Cases
    end

    %% Panel D: Case Study 3
    subgraph D["D: Case Study 3 - Influenza ODE"]
        direction TB
        D_ARIMA["ARIMA"]:::statistical
        D_Beta["Î²(t)"]:::epiLatent
        D_ODE["ODE"]:::infection
        D_Incidence["Incidence"]
        D_Delay["Delay"]:::observationModifier
        D_Obs["Poisson"]:::observation
        D_ObsCases["Cases"]

        D_ARIMA --> D_Beta
        D_Beta --> D_ODE
        D_ODE --> D_Incidence
        D_Incidence --> D_Delay
        D_Delay --> D_Obs
        D_Obs --> D_ObsCases
    end

    %% Style panels
    style A fill:#f9f9f9,stroke:#333,stroke-width:1px
    style B fill:#f9f9f9,stroke:#333,stroke-width:1px
    style C fill:#f9f9f9,stroke:#333,stroke-width:1px
    style D fill:#f9f9f9,stroke:#333,stroke-width:1px
```

## Notes
- Single diagram with 4 subgraphs
- Colour coding matches main composability schematic
- Panel A shows ARIMA composition; B, C, D show case study DAGs
- Reused components visible: AR/ARIMA (orange), Renewal/ODE (blue), Delay (red)
